<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="view.macro('arche:templates/base_view.pt', 'arche:templates/inline.pt')"
      i18n:domain="arche_m2m">
<body>
<div metal:fill-slot="main-content">

  <h1>${context.title}</h1>

  <a href="${request.resource_url(context, 'invite')}"
    class="btn btn-primary btn-sm"
    i18n:translate="">Invite</a>
  <a href="${request.resource_url(context, 'participants')}"
    class="btn btn-primary btn-sm"
    i18n:translate="">Participants</a>
  <a href="${request.resource_url(context, 'manage')}"
    class="btn btn-primary btn-sm"
    i18n:translate="">Manage</a>
  <a href="${request.resource_url(context, 'export.csv')}"
    class="btn btn-primary btn-sm"
    i18n:translate="">Export results</a>
  <br/><br/>

  <tal:iterate repeat="obj context.values()">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          <a href="${request.resource_url(obj)}">${obj.title}</a>
        </h3>
      </div>
      <div class="panel-body">
        <div>
          <ul>
          <tal:lang repeat="lang context.languages">
            <li tal:define="q_lang len(obj.get_questions(lang)); q_total len(obj.question_ids);">
              <form method="post" action="${request.resource_url(obj, 'translate_questions')}">
                <b>${lang}</b>
                <span class="label ${q_lang == q_total and 'label-success' or 'label-danger'}">${q_lang} / ${q_total}</span>
                <input type="hidden" name="language" value="${lang}" />
                <a tal:condition="request.locale_name != lang"
                  class="btn btn-default btn-xs"
                  href="${request.resource_url(obj, 'translate_questions', query = {'to_lang': lang})}"
                  i18n:translate="">Translate</a>
              </form>
            </li>
          </tal:lang>
          </ul>
        </div>
      </div>
    </div>
  </tal:iterate>

</div>
</body>
</html>
